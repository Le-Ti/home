#!/bin/sh
echo unfinished script
exit 1
function usage() {
	echo "usage: $0 COMMAND [DIR] [PATTERN]"
	echo "     Watches DIR for changes to files like PATTERN, and"
	echo "     calls COMMAND with their filename as an argument when"
	echo "     they are changed."
	echo 
	echo "     Example:"
	echo "     $0 recompile *.txt
	exit $1
}

target="./"
[ "$1" ] && target="$1"

pattern=""

exec 6<&0
inotifywait -qme close_write,moved_to "$target" | while read fn event filename;
	do
			[[ "$filename" =~ "$pattern" ]] || continue
			echo regenerating $filename \
			pandoc -s -S -o $filename.html $filename \
	done

